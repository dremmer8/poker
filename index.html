<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–†–∞—Å–ø–∏—Å–Ω–æ–π –ü–æ–∫–µ—Ä Score Counter</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-storage-compat.js"></script>
</head>
<body>
    <div class="container">
        <!-- Screen 1: Menu (Game not started) -->
        <div id="menuScreen" class="screen active">
            <header>
                <h1>–†–∞—Å–ø–∏—Å–Ω–æ–π –ü–æ–∫–µ—Ä</h1>
                <p>Russian Contract Bridge Score Counter</p>
            </header>
            
            <div class="menu-content">
                <div class="menu-card">
                    <h2>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!</h2>
                    <p>–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ –¥–ª—è –Ω–∞—á–∞–ª–∞ –∏–≥—Ä—ã:</p>
                    
                    <div class="menu-buttons">
                        <button class="menu-btn primary" onclick="showGameSetup()">
                            <span class="btn-icon">üéÆ</span>
                            <span class="btn-text">–ù–æ–≤–∞—è –∏–≥—Ä–∞</span>
                        </button>
                        
                        <button class="menu-btn secondary" onclick="loadSavedGame()">
                            <span class="btn-icon">üìÇ</span>
                            <span class="btn-text">–ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–≥—Ä—É</span>
                        </button>
                        
                        <button class="menu-btn info" onclick="showGameHistory()">
                            <span class="btn-icon">üìä</span>
                            <span class="btn-text">–ò—Å—Ç–æ—Ä–∏—è –∏–≥—Ä</span>
                        </button>
                        
                        <button class="menu-btn reset" onclick="resetCurrentGame()">
                            <span class="btn-icon">üîÑ</span>
                            <span class="btn-text">–°–±—Ä–æ—Å–∏—Ç—å –∏–≥—Ä—É</span>
                        </button>
                        
                        <button class="menu-btn players" onclick="showPlayerManagement()">
                            <span class="btn-icon">üë•</span>
                            <span class="btn-text">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–∞–º–∏</span>
                        </button>
                    </div>
                </div>
                
                <div class="menu-info">
                    <h3>–û –∏–≥—Ä–µ</h3>
                    <p>–†–∞—Å–ø–∏—Å–Ω–æ–π –ø–æ–∫–µ—Ä - —ç—Ç–æ –∫–∞—Ä—Ç–æ—á–Ω–∞—è –∏–≥—Ä–∞, –æ—Å–Ω–æ–≤–∞–Ω–Ω–∞—è –Ω–∞ –ø—Ä–∏–Ω—Ü–∏–ø–∞—Ö –±—Ä–∏–¥–∂–∞. –ò–≥—Ä–æ–∫–∏ –¥–µ–ª–∞—é—Ç —Å—Ç–∞–≤–∫–∏ –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–∑—è—Ç–æ–∫, –∫–æ—Ç–æ—Ä—ã–µ –æ–Ω–∏ –≤–æ–∑—å–º—É—Ç –≤ –∫–∞–∂–¥–æ–º —Ä–∞—É–Ω–¥–µ.</p>
                    
                    <div class="firebase-status" id="firebaseStatus">
                        <div class="status-indicator offline" id="statusIndicator">
                            <span class="status-dot"></span>
                            <span class="status-text">–û—Ñ–ª–∞–π–Ω</span>
                        </div>
                        <button class="sync-btn" id="syncBtn" onclick="syncWithFirebase()" style="display: none;">
                            üîÑ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∏–≥—Ä—É
                        </button>
                        <div class="session-info" id="sessionInfo" style="display: none;">
                            <small>–ò–≥—Ä–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏</small>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Screen 2: Game Setup -->
        <div id="setupScreen" class="screen">
            <header>
                <h1>–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏–≥—Ä—ã</h1>
                <p>–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–≥—Ä—ã –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º</p>
                <button class="back-btn" onclick="showMenu()">‚Üê –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é</button>
            </header>

            <div class="game-setup">
                <div class="player-setup">
                    <h2>–ò–≥—Ä–æ–∫–∏ (Players)</h2>
                    <div class="player-inputs">
                        <div class="player-input">
                            <input type="text" id="player1" placeholder="Player 1" value="Player 1">
                            <button class="remove-player" onclick="removePlayer(this)" style="display: none;">√ó</button>
                        </div>
                        <div class="player-input">
                            <input type="text" id="player2" placeholder="Player 2" value="Player 2">
                            <button class="remove-player" onclick="removePlayer(this)" style="display: none;">√ó</button>
                        </div>
                        <div class="player-input">
                            <input type="text" id="player3" placeholder="Player 3" value="Player 3">
                            <button class="remove-player" onclick="removePlayer(this)">√ó</button>
                        </div>
                        <div class="player-input">
                            <input type="text" id="player4" placeholder="Player 4" value="Player 4">
                            <button class="remove-player" onclick="removePlayer(this)">√ó</button>
                        </div>
                    </div>
                    <button class="add-player-btn" onclick="addPlayer()">+ Add Player</button>
                </div>

                <div class="game-settings">
                    <h2>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–≥—Ä—ã (Game Settings)</h2>
                                                                    <div class="setting-group">
                            <label for="deckSize">–†–∞–∑–º–µ—Ä –∫–æ–ª–æ–¥—ã (Deck Size):</label>
                            <select id="deckSize">
                                <option value="36">36 –∫–∞—Ä—Ç (36 Cards)</option>
                                <option value="54">54 –∫–∞—Ä—Ç (54 Cards)</option>
                            </select>
                        </div>
                </div>
                
                <div class="deck-preparation-tip" id="deckPreparationTip" style="display: none;">
                    <h2>üìã –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫–æ–ª–æ–¥—ã (Deck Preparation)</h2>
                    <div class="tip-content" id="tipContent">
                        <!-- Tip content will be populated by JavaScript based on selected deck size -->
                    </div>
                </div>
                
                <div class="setup-actions">
                    <button class="start-game-btn" onclick="startGame()">üéØ –ù–∞—á–∞—Ç—å –∏–≥—Ä—É</button>
                    <button class="edit-stages-btn" onclick="showStagesEdit()">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —ç—Ç–∞–ø—ã</button>
                </div>
            </div>
        </div>

        <!-- Screen 2.5: Stages Edit -->
        <div id="stagesEditScreen" class="screen">
            <header>
                <h1>–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —ç—Ç–∞–ø–æ–≤ –∏–≥—Ä—ã</h1>
                <p>–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —ç—Ç–∞–ø–æ–≤ –¥–ª—è –≤–∞—à–µ–π –∏–≥—Ä—ã</p>
                <button class="back-btn" onclick="showGameSetup()">‚Üê –ù–∞–∑–∞–¥ –∫ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ</button>
            </header>

            <div class="stages-edit">
                <div class="stages-info">
                    <h2>–¢–µ–∫—É—â–∏–µ —ç—Ç–∞–ø—ã</h2>
                    <p>–ù–∞—Å—Ç—Ä–æ–π—Ç–µ —ç—Ç–∞–ø—ã –∏–≥—Ä—ã. –ö–∞–∂–¥—ã–π —ç—Ç–∞–ø –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–∞—Ä—Ç –∏ —Ä–∞—É–Ω–¥–æ–≤.</p>
                    
                    <div class="stage-types-info">
                        <h3>–¢–∏–ø—ã —ç—Ç–∞–ø–æ–≤:</h3>
                        <ul>
                            <li><strong>golden</strong> - 1 –∫–∞—Ä—Ç–∞ (–∑–æ–ª–æ—Ç–æ–π —ç—Ç–∞–ø)</li>
                            <li><strong>rising</strong> - —É–≤–µ–ª–∏—á–∏–≤–∞—é—â–µ–µ—Å—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–∞—Ä—Ç</li>
                            <li><strong>full</strong> - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–∞—Ä—Ç</li>
                            <li><strong>decreasing</strong> - —É–º–µ–Ω—å—à–∞—é—â–µ–µ—Å—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–∞—Ä—Ç</li>
                            <li><strong>blind</strong> - –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–µ –∫–∞—Ä—Ç—ã (—Å–ª–µ–ø–æ–π —ç—Ç–∞–ø)</li>
                        </ul>
                    </div>
                </div>

                <div class="stages-config">
                    <h2>–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —ç—Ç–∞–ø–æ–≤</h2>
                    
                    <div class="stages-presets">
                        <h3>–ü—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:</h3>
                        <div class="preset-buttons">
                            <button class="preset-btn" onclick="loadPreset('default')">–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é</button>
                            <button class="preset-btn" onclick="loadPreset('golden')">–¢–æ–ª—å–∫–æ –∑–æ–ª–æ—Ç—ã–µ</button>
                            <button class="preset-btn" onclick="loadPreset('simple')">–ü—Ä–æ—Å—Ç–∞—è</button>
                            <button class="preset-btn" onclick="loadPreset('custom')">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è</button>
                        </div>
                    </div>

                    <div class="stages-editor">
                        <h3>–†–µ–¥–∞–∫—Ç–æ—Ä —ç—Ç–∞–ø–æ–≤:</h3>
                        <p class="stages-editor-info">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞—É–Ω–¥–æ–≤ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∏–≥—Ä–æ–∫–æ–≤ –∏ —Ç–∏–ø–∞ —ç—Ç–∞–ø–∞.</p>
                        <div class="stages-list" id="stagesList">
                            <!-- Stages will be populated by JavaScript -->
                        </div>
                        
                        <div class="stage-actions">
                            <button class="add-stage-btn" onclick="addStage()">+ –î–æ–±–∞–≤–∏—Ç—å —ç—Ç–∞–ø</button>
                            <button class="clear-stages-btn" onclick="clearStages()">–û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ</button>
                        </div>
                    </div>

                    <div class="stages-preview">
                        <h3>–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä:</h3>
                        <div class="preview-content" id="stagesPreview">
                            <!-- Preview will be populated by JavaScript -->
                        </div>
                    </div>
                </div>

                <div class="stages-actions">
                    <button class="save-stages-btn" onclick="saveStages()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —ç—Ç–∞–ø—ã</button>
                    <button class="reset-stages-btn" onclick="resetStages()">üîÑ –°–±—Ä–æ—Å–∏—Ç—å –∫ —É–º–æ–ª—á–∞–Ω–∏—é</button>
                </div>
            </div>
        </div>

        <!-- Screen 3: Bid and Trick Counting -->
        <div id="countingScreen" class="screen">
            <header>
                <h1>–†–∞—Å–ø–∏—Å–Ω–æ–π –ü–æ–∫–µ—Ä</h1>
                <p>–†–∞—É–Ω–¥ <span id="roundDisplay">1</span> - –ö–∞—Ä—Ç –≤ —Ä—É–∫–µ: <span id="cardsDisplay">1</span></p>
                <div id="phaseIndicator" class="phase-indicator">
                    <div class="phase-badge bidding-phase active" id="biddingPhaseBadge">
                        <span class="phase-icon">üéØ</span>
                        <span class="phase-text">–§–∞–∑–∞ —Å—Ç–∞–≤–æ–∫</span>
                    </div>
                    <div class="phase-badge tricks-phase" id="tricksPhaseBadge">
                        <span class="phase-icon">üÉè</span>
                        <span class="phase-text">–§–∞–∑–∞ –≤–∑—è—Ç–æ–∫</span>
                    </div>
                </div>
                <div id="saveStatus" style="display: none; background-color: #51cf66; color: white; padding: 5px 10px; border-radius: 3px; font-size: 12px; margin-top: 10px;">
                    üíæ –ò–≥—Ä–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ - –º–æ–∂–Ω–æ –∑–∞–∫—Ä—ã—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É
                </div>
            </header>

            <div class="game-status" id="gameStatus" style="display: none;">
                <div class="status-indicator locked">
                    <span>üîí –ò–≥—Ä–∞ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞</span>
                    <small>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–≥—Ä–æ–∫–æ–≤ –∏ —Ä–∞–∑–º–µ—Ä –∫–æ–ª–æ–¥—ã –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω—ã –¥–æ –∫–æ–Ω—Ü–∞ –∏–≥—Ä—ã</small>
                </div>
            </div>

            <!-- Rules Collapsible Section -->
            <div class="rules-section">
                <button class="rules-toggle" onclick="toggleRules()">
                    <span class="rules-icon">üìã</span>
                    <span class="rules-text">–ü—Ä–∞–≤–∏–ª–∞ —Ç–µ–∫—É—â–µ–≥–æ —Ä–∞—É–Ω–¥–∞</span>
                    <span class="rules-arrow">‚ñº</span>
                </button>
                <div class="rules-content" id="rulesContent" style="display: none;">
                    <div class="rules-info">
                        <h3>–ü—Ä–∞–≤–∏–ª–∞ –ø–æ–¥—Å—á–µ—Ç–∞ –æ—á–∫–æ–≤</h3>
                        <div id="scoringRulesText"></div>
                        <div class="round-details">
                            <p><strong>–†–∞—É–Ω–¥:</strong> <span id="roundDisplay3">1</span></p>
                            <p><strong>–ö–∞—Ä—Ç –≤ —Ä—É–∫–µ:</strong> <span id="cardsDisplay3">1</span></p>
                            <p><strong>–ö–æ–ª–æ–¥–∞:</strong> <span id="deckDisplay2">36</span> –∫–∞—Ä—Ç</p>
                            <p><strong>–í—Å–µ–≥–æ —Ä–∞—É–Ω–¥–æ–≤:</strong> <span id="totalRoundsDisplay2">30</span></p>
                        </div>
                        <div class="rules-actions">
                            <button class="help-btn" onclick="showBlindBiddingHelp()" style="background: linear-gradient(135deg, #ff6b6b, #ff8e8e); color: white; border: none; padding: 8px 16px; border-radius: 6px; font-size: 0.9rem; cursor: pointer; margin-top: 10px;">
                                üëÅÔ∏è –ü–æ–º–æ—â—å –ø–æ —Å–ª–µ–ø–æ–π —Å—Ç–∞–≤–∫–µ
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Phase-specific content -->
            <div class="phase-content">
                <!-- Bidding Phase -->
                <div id="biddingPhase" class="phase-section active">
                    <div class="phase-header">
                        <h2>üéØ –§–∞–∑–∞ —Å—Ç–∞–≤–æ–∫</h2>
                        <p>–ò–≥—Ä–æ–∫–∏ –¥–µ–ª–∞—é—Ç —Å—Ç–∞–≤–∫–∏ –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–∑—è—Ç–æ–∫. –ò–≥—Ä–æ–∫ —Å–ø—Ä–∞–≤–∞ –æ—Ç —Ä–∞–∑–¥–∞—é—â–µ–≥–æ –º–æ–∂–µ—Ç –¥–µ–ª–∞—Ç—å —Å–ª–µ–ø—É—é —Å—Ç–∞–≤–∫—É.</p>
                    </div>
                    
                    <!-- Minimalistic Player Grid for Bidding -->
                    <div class="minimal-scoreboard">
                        <div class="player-grid" id="biddingPlayerGrid">
                            <!-- Player tiles will be populated by JavaScript -->
                        </div>
                    </div>
                    
                                         <div class="phase-controls">
                         <button class="phase-btn primary" onclick="completeBiddingPhase()">‚úÖ –ó–∞–≤–µ—Ä—à–∏—Ç—å —Å—Ç–∞–≤–∫–∏</button>
                         <div class="bids-counter-bubble">
                             <div class="counter-label">–°–¢–ê–í–ö–ò</div>
                             <div class="counter-value" id="bidsCounter">0</div>
                             <div class="counter-status" id="bidsStatus">0/1</div>
                         </div>
                     </div>
                </div>

                <!-- Tricks Phase -->
                <div id="tricksPhase" class="phase-section">
                    <div class="phase-header">
                        <h2>üÉè –§–∞–∑–∞ –≤–∑—è—Ç–æ–∫</h2>
                        <p>–ò–≥—Ä–æ–∫–∏ –≤–≤–æ–¥—è—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ –≤–∑—è—Ç—ã—Ö –≤–∑—è—Ç–æ–∫.</p>
                    </div>
                    
                    <!-- Minimalistic Player Grid for Tricks -->
                    <div class="minimal-scoreboard">
                        <div class="player-grid" id="tricksPlayerGrid">
                            <!-- Player tiles will be populated by JavaScript -->
                        </div>
                    </div>
                    
                    <div class="phase-controls">
                        <button class="phase-btn primary" onclick="nextRound()">üéØ –°–ª–µ–¥—É—é—â–∏–π —Ä–∞—É–Ω–¥</button>
                        <button class="phase-btn secondary" onclick="showTricksHelp()">üìã –ü–æ–º–æ—â—å –ø–æ –≤–∑—è—Ç–∫–∞–º</button>
                        <button class="phase-btn back" onclick="backToBiddingPhase()">‚Üê –ù–∞–∑–∞–¥ –∫ —Å—Ç–∞–≤–∫–∞–º</button>
                    </div>
                </div>
            </div>

            <div class="game-controls">
                <button class="show-table-btn" onclick="showGameTable()">–ü–æ–∫–∞–∑–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É</button>
                <button class="end-game-btn" onclick="endGamePremature()" title="–ó–∞–≤–µ—Ä—à–∏—Ç—å –∏–≥—Ä—É –¥–æ—Å—Ä–æ—á–Ω–æ –∏ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø–æ–±–µ–¥–∏—Ç–µ–ª—è –ø–æ —Ç–µ–∫—É—â–∏–º –æ—á–∫–∞–º">üèÅ –ó–∞–≤–µ—Ä—à–∏—Ç—å –∏–≥—Ä—É</button>
                <button class="back-to-menu-btn" onclick="showMenu()">‚Üê –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é</button>
            </div>
        </div>

        <!-- Screen 4: Game Table -->
        <div id="tableScreen" class="screen">
            <header>
                <h1>–ò–≥—Ä–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞</h1>
                <p>–ü–æ–ª–Ω—ã–π –æ–±–∑–æ—Ä –∏–≥—Ä—ã –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏</p>
                <button class="back-btn" onclick="showCountingScreen()">‚Üê –ù–∞–∑–∞–¥ –∫ –ø–æ–¥—Å—á–µ—Ç—É</button>
            </header>

            <div class="game-table">
                <div class="table-section">
                    <h2>–¢–µ–∫—É—â–∏–µ –æ—á–∫–∏</h2>
                    <div class="scores-display" id="scoresDisplay">
                        <!-- Scores will be populated by JavaScript -->
                    </div>
                </div>

                <div class="table-section">
                    <h2>–ò—Å—Ç–æ—Ä–∏—è —Ä–∞—É–Ω–¥–æ–≤</h2>
                    <div class="rounds-history" id="roundsHistory">
                        <!-- Round history will be populated by JavaScript -->
                    </div>
                </div>

                <div class="table-section">
                    <h2>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–≥—Ä–æ–π</h2>
                    <div class="table-controls">
                        <button class="new-game-btn" onclick="newGame()">–ù–æ–≤–∞—è –∏–≥—Ä–∞</button>
                        <button class="reset-btn" onclick="resetGame()">–°–±—Ä–æ—Å</button>
                        <button class="clear-save-btn" onclick="clearSavedGame()" style="background-color: #ff6b6b; color: white;">–û—á–∏—Å—Ç–∏—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Screen 5: Game History -->
        <div id="historyScreen" class="screen">
            <header>
                <h1>–ò—Å—Ç–æ—Ä–∏—è –∏–≥—Ä</h1>
                <p>–ü—Ä–µ–¥—ã–¥—É—â–∏–µ –∏–≥—Ä—ã –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</p>
                <button class="back-btn" onclick="showMenu()">‚Üê –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é</button>
            </header>

            <div class="game-history">
                <div class="history-controls">
                    <div class="search-filters">
                        <input type="text" id="playerSearchInput" placeholder="–ü–æ–∏—Å–∫ –ø–æ –∏–≥—Ä–æ–∫—É..." class="search-input">
                        <select id="winnerFilter" class="filter-select">
                            <option value="">–í—Å–µ –ø–æ–±–µ–¥–∏—Ç–µ–ª–∏</option>
                        </select>
                        <select id="gameTypeFilter" class="filter-select">
                            <option value="">–í—Å–µ –∏–≥—Ä—ã</option>
                            <option value="completed">–ó–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ</option>
                            <option value="premature">–î–æ—Å—Ä–æ—á–Ω—ã–µ</option>
                        </select>
                        <button class="search-btn" onclick="searchGames()">üîç –ü–æ–∏—Å–∫</button>
                        <button class="refresh-btn" onclick="refreshGameHistory()">üîÑ –û–±–Ω–æ–≤–∏—Ç—å</button>
                    </div>
                    
                    <div class="view-controls">
                        <button class="view-btn active" onclick="setHistoryView('list')" data-view="list">üìã –°–ø–∏—Å–æ–∫</button>
                        <button class="view-btn" onclick="setHistoryView('stats')" data-view="stats">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</button>
                    </div>
                </div>

                <div class="history-content">
                    <div id="historyListView" class="history-view active">
                        <div class="history-list" id="gameHistory">
                            <!-- Game history will be populated by JavaScript -->
                        </div>
                    </div>
                    
                    <div id="historyStatsView" class="history-view">
                        <div class="stats-grid" id="gameStatsGrid">
                            <!-- Statistics will be populated by JavaScript -->
                        </div>
                        
                        <div class="player-stats" id="playerStatsSection">
                            <!-- Player statistics will be populated by JavaScript -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Screen 6: Game Details -->
        <div id="gameDetailsScreen" class="screen">
            <header>
                <h1>–î–µ—Ç–∞–ª–∏ –∏–≥—Ä—ã</h1>
                <p>–ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –∏–≥—Ä–µ</p>
                <button class="back-btn" onclick="showGameHistory()">‚Üê –ù–∞–∑–∞–¥ –∫ –∏—Å—Ç–æ—Ä–∏–∏</button>
            </header>

            <div class="game-details-content" id="gameDetailsContent">
                <!-- Game details will be populated by JavaScript -->
            </div>
        </div>

        <!-- Screen 7: Game Celebration -->
        <div id="celebrationScreen" class="screen">
            <header>
                <h1>üéâ –ò–≥—Ä–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!</h1>
                <p>–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º –ø–æ–±–µ–¥–∏—Ç–µ–ª—è!</p>
            </header>

            <div class="celebration-content">
                <div class="winner-section">
                    <div class="winner-card" id="winnerCard">
                        <!-- Winner information will be populated by JavaScript -->
                    </div>
                </div>

                <div class="final-stats">
                    <div class="stats-card">
                        <h3>üìä –§–∏–Ω–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
                        <div class="final-scores" id="finalScores">
                            <!-- Final scores will be populated by JavaScript -->
                        </div>
                    </div>
                </div>

                <div class="round-data">
                    <div class="rounds-card">
                        <h3>üìã –î–∞–Ω–Ω—ã–µ –≤—Å–µ—Ö —Ä–∞—É–Ω–¥–æ–≤</h3>
                        <div class="rounds-summary" id="roundsSummary">
                            <!-- Round data will be populated by JavaScript -->
                        </div>
                    </div>
                </div>

                <div class="celebration-actions">
                    <button class="new-game-celebration-btn" onclick="startNewGameFromCelebration()">üéÆ –ù–æ–≤–∞—è –∏–≥—Ä–∞</button>
                    <button class="view-history-btn" onclick="showGameHistory()">üìä –ò—Å—Ç–æ—Ä–∏—è –∏–≥—Ä</button>
                    <button class="back-to-menu-celebration-btn" onclick="showMenu()">üè† –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é</button>
                </div>
            </div>
        </div>

        <!-- Screen 8: Round Transition -->
        <div id="transitionScreen" class="screen">
            <div class="transition-container">
                <div class="transition-content">
                    <div class="transition-header">
                        <div class="header-main">
                            <div class="header-title">
                                <h1>üéØ –†–∞—É–Ω–¥ <span id="transitionRoundNumber">1</span></h1>
                                <p>–ö–∞—Ä—Ç –≤ —Ä—É–∫–µ: <span id="transitionCardsPerHand">1</span></p>
                            </div>
                            <div class="header-controls">
                                <div class="transition-timer">
                                    <div class="timer-display">
                                        <span id="transitionTimer">15</span>
                                    </div>
                                    <p>—Å–µ–∫—É–Ω–¥ –¥–æ –Ω–∞—á–∞–ª–∞ —Ä–∞—É–Ω–¥–∞</p>
                                </div>
                                <button class="start-round-btn" onclick="startRoundFromTransition()">üéØ –ù–∞—á–∞—Ç—å —Ä–∞—É–Ω–¥</button>
                            </div>
                        </div>
                    </div>

                    <div class="transition-info">
                        <div class="info-section dealer-info">
                            <h3>üéØ –†–∞–∑–¥–∞—é—â–∏–π</h3>
                            <div class="dealer-display" id="transitionDealer">Player 1</div>
                        </div>

                        <div class="info-section players-info">
                            <h3>üë• –ò–≥—Ä–æ–∫–∏ –∏ –∫–∞—Ä—Ç—ã</h3>
                            <div class="players-cards" id="transitionPlayersCards">
                                <!-- Player cards will be populated by JavaScript -->
                            </div>
                        </div>

                        <div class="info-section previous-round" id="transitionPreviousRound" style="display: none;">
                            <h3>üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Ä–∞—É–Ω–¥–∞</h3>
                            <div class="previous-round-results" id="transitionPreviousResults">
                                <!-- Previous round results will be populated by JavaScript -->
                            </div>
                        </div>

                        <div class="info-section game-stage">
                            <h3>üéÆ –≠—Ç–∞–ø –∏–≥—Ä—ã</h3>
                            <div class="stage-info" id="transitionStageInfo">
                                <!-- Stage info will be populated by JavaScript -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Screen 8: Player Management -->
        <div id="playerManagementScreen" class="screen">
            <header>
                <h1>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–∞–º–∏</h1>
                <p>–î–æ–±–∞–≤–ª—è–π—Ç–µ, —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –∏ —É–ø—Ä–∞–≤–ª—è–π—Ç–µ –ø—Ä–æ—Ñ–∏–ª—è–º–∏ –∏–≥—Ä–æ–∫–æ–≤</p>
                <button class="back-btn" onclick="showMenu()">‚Üê –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é</button>
            </header>

            <div class="player-management">
                <div class="add-player-section">
                    <h2>–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–≥–æ –∏–≥—Ä–æ–∫–∞</h2>
                    <div class="add-player-form">
                        <div class="form-group">
                            <label for="newPlayerName">–ò–º—è –∏–≥—Ä–æ–∫–∞:</label>
                            <input type="text" id="newPlayerName" placeholder="–í–≤–µ–¥–∏—Ç–µ –∏–º—è –∏–≥—Ä–æ–∫–∞" maxlength="20">
                        </div>
                        
                        <div class="form-group">
                            <label for="playerImageInput">–§–æ—Ç–æ –∏–≥—Ä–æ–∫–∞:</label>
                            <div class="image-upload-container">
                                <input type="file" id="playerImageInput" accept="image/*" style="display: none;">
                                <button type="button" class="image-upload-btn" onclick="document.getElementById('playerImageInput').click()">
                                    <span class="upload-icon">üì∑</span>
                                    <span class="upload-text">–í—ã–±—Ä–∞—Ç—å —Ñ–æ—Ç–æ</span>
                                </button>
                                <div class="image-preview" id="imagePreview" style="display: none;">
                                    <img id="previewImage" src="" alt="Preview">
                                    <button type="button" class="remove-image-btn" onclick="removeImagePreview()">√ó</button>
                                </div>
                            </div>
                        </div>
                        
                        <button class="add-player-submit-btn" onclick="addNewPlayer()">‚ûï –î–æ–±–∞–≤–∏—Ç—å –∏–≥—Ä–æ–∫–∞</button>
                    </div>
                </div>

                <div class="players-list-section">
                    <h2>–°–ø–∏—Å–æ–∫ –∏–≥—Ä–æ–∫–æ–≤</h2>
                    <div class="players-list" id="playersList">
                        <!-- Players will be populated by JavaScript -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="firebase-config.js"></script>
    <script src="script.js"></script>
</body>
</html> 